Script started on 2022-11-14 00:53:14-05:00
[sohan@sjsu twitter]$ grep type=retweeted downloaded_tweets_extend_nolf2.tsv | cut -f5 | sed 's/\[<ReferencedTweet id=//g' | sed 's/type=retweeted]//g' | sort > all_retweet_ids.tsv
[sohan@sjsu twitter]$ cut -f1,2 downloaded_tweets_extend_original_nolf2.tsv | sort -k1 > all_tweets_authors.tsv
[sohan@sjsu twitter]$ join -1 1 -2 1 all_retweet_ids.tsv all_tweets_authors.tsv | awk '{print $2}' | sort -n | uniq -c | awk '$1>=3{print $2}' > top_authors.tsv
[sohan@sjsu twitter]$ for i in `cat top_authors.tsv`; do grep -E -w "$i" all_tweets_authors.tsv; done | cut -f1 > filtered_tweets.tsv
[sohan@sjsu twitter]$ grep type=retweeted downloaded_tweets_extend_nolf2.tsv | cut -f2,4,5 > required_columns.tsv
[sohan@sjsu twitter]$ for i in `cat filtered_tweets.tsv`; do grep -E -w "$i" required_columns.tsv; done | tr '[:upper:]' '[:lower:]'  > filtered_final_tweets.tsv
[sohan@sjsu twitter]$ cut -f2 filtered_final_tweets.tsv |  sed 's/[""]//g' | tr '[:upper:]' '[:lower:]' | tr , '\n' | sort | uniq > found_hashtags.tsv
[sohan@sjsu twitter]$ cat retweetFrequencies.sh
#!/bin/bash
echo hashtag_H, cluster_C_leader_user_id, relative_frequency_H_C, frequency_H_in_C, frequency_H_overall, count_H_in_C, count_tweets_in_C, count_H_entire_dataset, count_tweets_entire_dataset
total_hashtags_entire_dataset=$(grep type=retweeted downloaded_tweets_extend_nolf2.tsv | cut -f4 | sed 's/[""]//g' | tr '[:upper:]' '[:lower:]' | tr , '\n' | sort | uniq | wc | awk '{print $1}')
total_hashtags_in_cluster=$(wc found_hashtags.tsv | awk '{print $1}')
for i in `cat found_hashtags.tsv`
do
        leader_user_id=$(grep -E -w "$i" filtered_final_tweets.tsv | cut -f1 | sort | uniq -c | sort -nr | head -1 | awk '{print $2}')
        count_hashtags_entire_dataset=$(grep type=retweeted downloaded_tweets_extend_nolf2.tsv | cut -f4  | tr '[:upper:]' '[:lower:]'| grep -E -w "$i" | wc | awk '{print $1}')
        count_hashtags_in_cluster=$(grep -E -w "$i" filtered_final_tweets.tsv | wc | awk '{print $1}')
        frequency_H_in_C=$(echo $count_hashtags_in_cluster / $total_hashtags_in_cluster | bc -l)
        frequency_H_overall=$(echo $count_hashtags_entire_dataset / $total_hashtags_entire_dataset | bc -l)
        relative_frequency_H_C=$(echo $frequency_H_in_C / $frequency_H_overall | bc -l)


        echo $i, $leader_user_id, $relative_frequency_H_C, $frequency_H_in_C, $frequency_H_overall, $count_hashtags_in_cluster, $total_hashtags_in_cluster, $count_hashtags_entire_dataset, $total_hashtags_entire_dataset

done

[sohan@sjsu twitter]$ . retweetFrequencies.sh > retweets_hashtag_freqs.csv
[sohan@sjsu twitter]$ sed 's/,/\t/g' retweets_hashtag_freqs.csv > retweets_hashtag_freqs.tsv
[sohan@sjsu twitter]$ grep type=replied_to downloaded_tweets_extend_original_nolf2.tsv | cut -f1,2,4,6 | awk '$2!=$4{print $0}' | tr '[:upper:]' '[:lower:]' >  replies_cleaned.tsv 
[sohan@sjsu twitter]$ cut -f4 replies_cleaned.tsv | sort -n | uniq -c  | awk '$1>=3{print $2}' > authors_three_or_more_replies.tsv
[sohan@sjsu twitter]$ for i in `cat authors_three_or_more_replies.tsv`; do awk -v word=$i 'word==$4{print $0}' replies_cleaned.tsv | tr '[:upper:]' '[:lower:]'; done > three_or_more.tsv
[sohan@sjsu twitter]$ cut -f3 three_or_more.tsv |  sed 's/[""]//g' | tr '[:upper:]' '[:lower:]' | tr , '\n' | sort | uniq > hashtags_for_replies_full.tsv
[sohan@sjsu twitter]$ cat repliesFrequencies.sh
#!/bin/bash
echo hashtag_H, cluster_C_leader_user_id, relative_frequency_H_C, frequency_H_in_C, frequency_H_overall, count_H_in_C, count_tweets_in_C, count_H_entire_dataset, count_tweets_entire_dataset

total_hashtags_entire_dataset=$(cut -f3 replies_cleaned.tsv | tr , '\n' | wc |  awk '{print $1}')
total_hashtags_in_cluster=$(wc hashtags_for_replies_full.tsv | awk '{print $1}')

for i in `cat hashtags_for_replies_full.tsv`
do
	leader_user_id=$(grep -E -w "$i" three_or_more.tsv | cut -f1 | sort | uniq -c | sort -nr | head -1 | awk '{print $2}')
	count_hashtags_entire_dataset=$(cut -f3 replies_cleaned.tsv | tr , '\n' | grep -E -w "$i" | wc | awk '{print $1}')
	count_hashtags_in_cluster=$(grep -E -w "$i" three_or_more.tsv | wc | awk '{print $1}')
	frequency_H_in_C=$(echo $count_hashtags_in_cluster / $total_hashtags_in_cluster | bc -l)
	frequency_H_overall=$(echo $count_hashtags_entire_dataset / $total_hashtags_entire_dataset | bc -l)
	relative_frequency_H_C=$(echo $frequency_H_in_C / $frequency_H_overall | bc -l)
	


	 echo $i, $leader_user_id, $relative_frequency_H_C, $frequency_H_in_C, $frequency_H_overall, $count_hashtags_in_cluster, $total_hashtags_in_cluster, $count_hashtags_entire_dataset, $total_hashtags_entire_dataset

done
[sohan@sjsu twitter]$ . repliesFrequencies.sh > replies__hashtag_freqs.csv
[sohan@sjsu twitter]$  sed 's/,/\t/g' replies__hashtag_freqs.csv > replies__hashtag_freqs.tsv
[sohan@sjsu twitter]$ exit

Script done on 2022-11-14 01:11:57-05:00
